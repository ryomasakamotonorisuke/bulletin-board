# 🎉 セットアップ完了ガイド

## ✅ 実装完了した機能

1. ✅ メールアドレスでログイン
2. ✅ 初回ログイン時にパスワード変更を強制
3. ✅ 管理者のみがユーザーを作成可能
4. ✅ ユーザーのオンオフトグル（アクティブ/無効）
5. ✅ CSVエクスポート機能
6. ✅ ダッシュボード（統計情報）

---

## 📋 今すぐ実行すべきこと

### 1. データベースセットアップ

Supabase SQL Editorで `prepare-admin-account.sql` を実行：

1. Supabaseダッシュボードにアクセス
2. SQL Editorを開く
3. `prepare-admin-account.sql` の内容をコピー
4. 実行

**重要**: ステップ1で表示される管理者のメールアドレスをメモしてください。

### 2. 管理者アカウントを確認

SQL実行後、以下で管理者を確認：

```sql
SELECT 
  u.email as ログインメールアドレス,
  p.full_name as 氏名,
  p.is_admin,
  p.password_changed
FROM profiles p
JOIN auth.users u ON p.id = u.id
WHERE p.is_admin = true;
```

### 3. Vercelでデプロイ確認

- https://vercel.com にアクセス
- プロジェクト「bulletin-board」を選択
- 最新のデプロイが完了しているか確認

---

## 🔑 ログイン方法

### 初回ログイン

1. デプロイされたサイトにアクセス
2. メールアドレス欄に管理者のメールアドレスを入力
3. パスワードを入力
4. ログインボタンをクリック
5. **パスワード変更画面が表示されます**
   - 新しいパスワードを入力
   - 確認用パスワードを入力
   - 「パスワードを変更する」をクリック
6. メイン画面に移動します

### 2回目以降のログイン

1. メールアドレスと新しいパスワードでログイン
2. 直接メイン画面に移動します

---

## 👥 新しいユーザーの作成

1. 管理者でログイン
2. ヘッダーの「管理画面」をクリック
3. 「ユーザー作成」タブを選択
4. 以下を入力：
   - **メールアドレス**: 新規ユーザーのメールアドレス（ログインIDとして使用）
   - **パスワード**: 初期パスワード
   - **氏名**: フルネーム
   - **ユーザー名**: 任意
   - **管理者権限**: チェックして管理者にする
5. 「ユーザーを作成」をクリック

作成されたユーザーは初回ログイン時にパスワード変更が求められます。

---

## 🎯 機能の使い方

### ダッシュボード
- 管理画面の最初のタブ
- 総ユーザー数、管理者数、投稿数などを表示

### ユーザー管理
- **状態トグル**: 緑「アクティブ」/赤「無効」を切り替え
- **CSVエクスポート**: ユーザー一覧をダウンロード
- **管理者権限**: クリックして管理者/一般を切り替え

### 投稿管理
- 全投稿を表示
- 投稿の編集・削除が可能

---

## 🚨 トラブルシューティング

### ログインできない場合

1. **メールアドレスとパスワードを確認**
   - Supabaseで確認: Authentication → Users
2. **ブラウザのコンソールを確認**
   - F12キーで開発者ツール
   - Consoleタブでエラーを確認
3. **データベースを確認**
   - ステップ1のSQLを実行して、管理者が存在するか確認

### パスワード変更画面が表示されない

- データベースで `password_changed` を `false` に設定
- ページをリロード

### 管理者画面にアクセスできない

- `is_admin` が `true` か確認
- SQLを実行: `SELECT * FROM profiles WHERE email = 'your@email.com';`

---

## 📝 今後のメンテナンス

### ユーザーを無効化する
- ユーザー管理画面で「アクティブ」をクリック → 「無効」に変更

### 新しいユーザーを作成
- 管理画面 → ユーザー作成 → 必要事項を入力

### CSVでユーザー管理
- エクスポートしてダウンロード
- 必要に応じて編集して再度インポート（機能実装予定）

---

## ✅ 完了！

これで以下の機能が使えます：

- ✅ セキュアな認証システム
- ✅ 初回パスワード変更の強制
- ✅ 管理者のみがユーザーを作成
- ✅ ユーザーのアクティブ/無効管理
- ✅ CSVエクスポート
- ✅ 統計ダッシュボード

準備できました！🎉

